### Step 1: Create a New Helm Chart

1. **Navigate to your Helm charts directory**:
   ```bash
   cd /workspaces/kuma-lab/kuma-lab/helm
   ```

2. **Create a new Helm chart**:
   ```bash
   helm create prometheus-grafana
   ```

This command will create a new directory called `prometheus-grafana` with a basic Helm chart structure.

### Step 2: Modify `values.yaml`

Navigate to the `prometheus-grafana` directory and edit the `values.yaml` file to configure Prometheus and Grafana. Hereâ€™s an example configuration:

```yaml
# filepath: /workspaces/kuma-lab/kuma-lab/helm/prometheus-grafana/values.yaml

prometheus:
  enabled: true
  service:
    enabled: true
    type: ClusterIP
    port: 9090

grafana:
  enabled: true
  admin:
    user: admin
    password: admin
  service:
    enabled: true
    type: LoadBalancer
    port: 80
```

### Step 3: Update the Chart Template

You may want to customize the templates generated by Helm. Navigate to the `templates` directory and modify the files as needed. For example, you can adjust the `deployment.yaml`, `service.yaml`, and other templates to fit your requirements.

### Step 4: Install the Chart

1. **Package the chart** (optional):
   ```bash
   helm package prometheus-grafana
   ```

2. **Install the chart**:
   ```bash
   helm install prometheus-grafana ./prometheus-grafana
   ```

### Step 5: Verify the Installation

Check if the Prometheus and Grafana pods are running:

```bash
kubectl get pods
```

You should see pods for both Prometheus and Grafana.

### Step 6: Access Grafana

If you set the Grafana service type to `LoadBalancer`, you can access Grafana using the external IP assigned to the service:

```bash
kubectl get svc
```

Look for the service named `prometheus-grafana` and note the external IP. You can access Grafana in your web browser at `http://<external-ip>`.

### Step 7: Configure Prometheus Data Source in Grafana

1. Log in to Grafana using the credentials specified in `values.yaml` (default: `admin/admin`).
2. Add Prometheus as a data source by navigating to **Configuration > Data Sources** and selecting Prometheus.
3. Set the URL to `http://prometheus:9090` (or the appropriate service name if different).

### Conclusion

You now have a Helm chart for installing Prometheus and Grafana in your Kuma Lab environment. You can further customize the configurations and templates as needed for your specific use case.